'use strict';function _0xbc4b(){const _0x275fdf=['create','402SamEps','862905JRbxTk','./controllers','express','env','listen','sub','public','./middleware/swagger_validator_handler','path','./knex/knex.js','mailingTransporter','swagger-tools','ExtractJwt','9MIoXhG','join','port','js-yaml','use','log_iat','queryByFilter','initializeMiddleware','./config/mailing','1094502QTQJbm','verify','7cxfOby','exports','PORT','7142661rdlTwd','safeLoad','swaggerValidator','passport','3873312JRhYFG','config','nodemailer','readFileSync','./middleware/user_activity_handler','694474KVulkk','Strategy','createTransport','cors','fromAuthHeaderAsBearerToken','log','secure','swaggerMetadata','94735VKTSHE','1137880uxQVMS','host','locals','./middleware/auth_handler','./repository/RepositoryFactory','queryById','swaggerRouter','development','350YNaPZk'];_0xbc4b=function(){return _0x275fdf;};return _0xbc4b();}const _0x229029=_0x246e;(function(_0x2fa674,_0xcfa0d9){const _0x1bd59b=_0x246e,_0x2ddd0b=_0x2fa674();while(!![]){try{const _0x157c96=parseInt(_0x1bd59b(0xc1))/0x1+-parseInt(_0x1bd59b(0xd7))/0x2+parseInt(_0x1bd59b(0xce))/0x3*(parseInt(_0x1bd59b(0xee))/0x4)+parseInt(_0x1bd59b(0xed))/0x5*(-parseInt(_0x1bd59b(0xc0))/0x6)+parseInt(_0x1bd59b(0xd9))/0x7*(-parseInt(_0x1bd59b(0xe0))/0x8)+-parseInt(_0x1bd59b(0xdc))/0x9+parseInt(_0x1bd59b(0xbe))/0xa*(parseInt(_0x1bd59b(0xe5))/0xb);if(_0x157c96===_0xcfa0d9)break;else _0x2ddd0b['push'](_0x2ddd0b['shift']());}catch(_0x413ca0){_0x2ddd0b['push'](_0x2ddd0b['shift']());}}}(_0xbc4b,0xcb018));require('dotenv')[_0x229029(0xe1)]();const passport=require(_0x229029(0xdf)),passportJWT=require('passport-jwt'),ExtractJWT=passportJWT[_0x229029(0xcd)],JwtStrategy=passportJWT[_0x229029(0xe6)],passportOpts={'jwtFromRequest':ExtractJWT[_0x229029(0xe9)](),'secretOrKey':process[_0x229029(0xc4)]['JWT_SECRET']},fs=require('fs'),path=require(_0x229029(0xc9)),express=require(_0x229029(0xc3));var app=express();const swaggerTools=require(_0x229029(0xcc)),jsyaml=require(_0x229029(0xd1)),options={'swaggerUi':path[_0x229029(0xcf)](__dirname,'/swagger.json'),'controllers':path[_0x229029(0xcf)](__dirname,_0x229029(0xc2)),'useStubs':process['env']['NODE_ENV']===_0x229029(0xbd)};var spec=fs[_0x229029(0xe3)](path[_0x229029(0xcf)](__dirname,'api/swagger.yaml'),'utf8'),swaggerDoc=jsyaml[_0x229029(0xdd)](spec);const knex=require(_0x229029(0xca)),{RepositoryName,RepositoryFactory}=require(_0x229029(0xf2));RepositoryFactory['initialize'](knex);function _0x246e(_0x2b06cd,_0xa6c511){const _0xbc4b82=_0xbc4b();return _0x246e=function(_0x246e31,_0x5951ef){_0x246e31=_0x246e31-0xbd;let _0x24a9b2=_0xbc4b82[_0x246e31];return _0x24a9b2;},_0x246e(_0x2b06cd,_0xa6c511);}const nodemailer=require(_0x229029(0xe2)),{service}=require(_0x229029(0xd6)),transporter=nodemailer[_0x229029(0xe7)]({'host':service[_0x229029(0xef)],'port':service[_0x229029(0xd0)],'secure':service[_0x229029(0xeb)],'auth':{'user':service['user'],'pass':service['password']}});transporter[_0x229029(0xd8)](function(_0xb539b1,_0x22cd54){const _0x332f16=_0x229029;_0xb539b1?console[_0x332f16(0xea)](_0xb539b1):console[_0x332f16(0xea)]('Server\x20is\x20ready\x20to\x20take\x20our\x20messages');}),app[_0x229029(0xf0)][_0x229029(0xcb)]=transporter;const cors=require(_0x229029(0xe8)),swaggerValidatorHandler=require(_0x229029(0xc8)),userActivityHandler=require(_0x229029(0xe4)),errorHandler=require('./middleware/error_handler');swaggerTools[_0x229029(0xd5)](swaggerDoc,function(_0x7e8c37){const _0x1cadd8=_0x229029;app[_0x1cadd8(0xd2)](express['static'](_0x1cadd8(0xc7))),app['use'](_0x7e8c37[_0x1cadd8(0xec)]()),app[_0x1cadd8(0xd2)](cors()),passport[_0x1cadd8(0xd2)](new JwtStrategy(passportOpts,async function(_0x16c756,_0x5314bd){const _0x46edae=_0x1cadd8,_0x5a5859=RepositoryFactory[_0x46edae(0xbf)](RepositoryName['Session']),_0x368a1d=_0x5a5859[_0x46edae(0xd4)]({'userId':_0x16c756['sub'],'iat':_0x16c756['iat']});if(!_0x368a1d)return _0x5314bd(null,![]);const _0x171c07=RepositoryFactory[_0x46edae(0xbf)](RepositoryName['User']);let _0x10882b=await _0x171c07[_0x46edae(0xf3)](_0x16c756[_0x46edae(0xc6)]);return _0x10882b?(_0x10882b[_0x46edae(0xd3)]=_0x16c756['iat'],_0x5314bd(null,_0x10882b)):_0x5314bd(null,![]);}));const _0x4aa41d=require(_0x1cadd8(0xf1))(passport);app[_0x1cadd8(0xd2)](passport['initialize']()),app[_0x1cadd8(0xd2)](_0x4aa41d),app[_0x1cadd8(0xd2)](userActivityHandler()),app[_0x1cadd8(0xd2)](_0x7e8c37[_0x1cadd8(0xde)]({'validateResponse':![]})),app[_0x1cadd8(0xd2)](swaggerValidatorHandler),app[_0x1cadd8(0xd2)](_0x7e8c37[_0x1cadd8(0xf4)](options)),app[_0x1cadd8(0xd2)](_0x7e8c37['swaggerUi']()),app['use'](errorHandler),app[_0x1cadd8(0xc5)](process[_0x1cadd8(0xc4)][_0x1cadd8(0xdb)]||0x1f90,function(){const _0x4a0462=_0x1cadd8;console[_0x4a0462(0xea)]('Swagger-ui\x20is\x20available\x20on\x20http://localhost:%d/docs',process[_0x4a0462(0xc4)][_0x4a0462(0xdb)]);});}),module[_0x229029(0xda)]=app;