'use strict';function _0x33a6(_0xa8de50,_0x4ffc01){const _0x953cd4=_0x953c();return _0x33a6=function(_0x33a60a,_0x4db113){_0x33a60a=_0x33a60a-0xb0;let _0x3fc8d9=_0x953cd4[_0x33a60a];return _0x3fc8d9;},_0x33a6(_0xa8de50,_0x4ffc01);}const _0x2094e6=_0x33a6;function _0x953c(){const _0x1f3293=['retrieveList','152kfNOuf','52876fIaYTr','656616QPHFZk','Favourite','4bgtXCt','User','content','exports','167292jKrysu','21048uWWlfu','queryByAdvancedFilter','../repository/RepositoryFactory','all','mapRoutineEntity','userId','852665rxRnRX','mapPublicUserEntity','categoryId','create','2532282jCahwJ','queryById','routineId','insert','1955233JOvZVn','\x20not\x20found','./ModelMapper','map','Routine\x20id\x20'];_0x953c=function(){return _0x1f3293;};return _0x953c();}(function(_0xb583fc,_0x5afbaa){const _0x557891=_0x33a6,_0x595dd2=_0xb583fc();while(!![]){try{const _0x47dcf1=parseInt(_0x557891(0xc8))/0x1*(-parseInt(_0x557891(0xcb))/0x2)+parseInt(_0x557891(0xb3))/0x3+-parseInt(_0x557891(0xc9))/0x4+parseInt(_0x557891(0xb9))/0x5+parseInt(_0x557891(0xbd))/0x6+parseInt(_0x557891(0xc1))/0x7+-parseInt(_0x557891(0xc7))/0x8*(parseInt(_0x557891(0xb2))/0x9);if(_0x47dcf1===_0x5afbaa)break;else _0x595dd2['push'](_0x595dd2['shift']());}catch(_0x1b916e){_0x595dd2['push'](_0x595dd2['shift']());}}}(_0x953c,0x3e75d));const {RepositoryName,RepositoryFactory}=require(_0x2094e6(0xb5)),{ModelMapper}=require(_0x2094e6(0xc3)),{NotFoundError}=require('../errors/errors');async function ensureCategory(_0x4004ae){const _0x2b0d5b=_0x2094e6,_0x58c929=RepositoryFactory[_0x2b0d5b(0xbc)](RepositoryName['Category']);let _0x35a513=await _0x58c929[_0x2b0d5b(0xbe)](_0x4004ae);if(!_0x35a513)throw new NotFoundError(['Category\x20id\x20'+_0x4004ae+_0x2b0d5b(0xc2)]);return _0x35a513;}async function ensureRoutine(_0x1b150d){const _0x12be14=_0x2094e6,_0x2139f6=RepositoryFactory['create'](RepositoryName['Routine']);let _0x1497bc=await _0x2139f6[_0x12be14(0xbe)](_0x1b150d);if(!_0x1497bc)throw new NotFoundError([_0x12be14(0xc5)+_0x1b150d+_0x12be14(0xc2)]);return _0x1497bc;}async function deepMapFavourite(_0x4afd38){const _0x188987=_0x2094e6,_0x162020=await ensureRoutine(_0x4afd38[_0x188987(0xbf)]),_0xcb015a=RepositoryFactory[_0x188987(0xbc)](RepositoryName[_0x188987(0xcc)]),_0x50edc=await _0xcb015a[_0x188987(0xbe)](_0x162020[_0x188987(0xb8)]);let _0x41f3e3;if(_0x162020[_0x188987(0xbb)])_0x41f3e3=await ensureCategory(_0x162020[_0x188987(0xbb)]);return ModelMapper['mapFavouriteEntity'](_0x4afd38,ModelMapper[_0x188987(0xb7)](_0x162020,_0x50edc?ModelMapper[_0x188987(0xba)](_0x50edc):undefined,_0x41f3e3?ModelMapper['mapCategoryEntity'](_0x41f3e3):undefined));}module[_0x2094e6(0xb1)]['add']=async(_0x1a6bc5,_0x25e467)=>{const _0x1e008a=_0x2094e6;await ensureRoutine(_0x25e467);const _0x27fd54=RepositoryFactory[_0x1e008a(0xbc)](RepositoryName['Favourite']);await _0x27fd54[_0x1e008a(0xc0)]({'userId':_0x1a6bc5['id'],'routineId':_0x25e467});},module[_0x2094e6(0xb1)]['remove']=async(_0x13d78d,_0x5c293c)=>{const _0x53af72=_0x2094e6;await ensureRoutine(_0x5c293c);const _0x377dfb=RepositoryFactory[_0x53af72(0xbc)](RepositoryName[_0x53af72(0xca)]);await _0x377dfb['deleteByFilter']({'userId':_0x13d78d['id'],'routineId':_0x5c293c});},module[_0x2094e6(0xb1)][_0x2094e6(0xc6)]=async(_0x50b7ac,_0x2f6090,_0x1e8822,_0x22b7ca,_0x218a84)=>{const _0x2ebed5=_0x2094e6,_0x14e9b8={'userId':_0x50b7ac['id']},_0x387f3f=RepositoryFactory[_0x2ebed5(0xbc)](RepositoryName[_0x2ebed5(0xca)]);let _0x49e21e=await _0x387f3f[_0x2ebed5(0xb4)](_0x14e9b8,null,_0x2f6090,_0x1e8822,_0x22b7ca,_0x218a84);return _0x49e21e['content']=await Promise[_0x2ebed5(0xb6)](_0x49e21e[_0x2ebed5(0xb0)][_0x2ebed5(0xc4)](async _0x29500c=>{return await deepMapFavourite(_0x29500c);})),_0x49e21e;};